<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Lab 4 - Metrics APIs - BMC TrueSight Intelligence</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">BMC TrueSight Intelligence</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../getting_started/prerequisites/">Prerequisites</a>
</li>

                    
                        
<li >
    <a href="../../getting_started/signup/">Sign-Up</a>
</li>

                    
                        
<li >
    <a href="../../getting_started/virtual_machine/">Virtual Machine</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Labs <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../lab1/">Lab 1 - Meters and Meter Plugins</a>
</li>

                    
                        
<li >
    <a href="../lab2/">Lab 2 - Introduction ReST</a>
</li>

                    
                        
<li >
    <a href="../lab3/">Lab 3 - Event APIs</a>
</li>

                    
                        
<li class="active">
    <a href="./">Lab 4 - Metrics APIs</a>
</li>

                    
                        
<li >
    <a href="../lab5/">Lab 5 - Log File to API</a>
</li>

                    
                        
<li >
    <a href="../lab6/">Lab 6 - API Integration</a>
</li>

                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                <li >
                    <a rel="next" href="../lab3/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../lab5/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#lab-4-metric-and-measurement-apis">Lab 4 - Metric and Measurement APIs</a></li>
        
            <li><a href="#overview">Overview</a></li>
        
            <li><a href="#metric-and-measurement-apis">Metric and Measurement APIs</a></li>
        
            <li><a href="#business-data">Business Data</a></li>
        
            <li><a href="#exercise-4-1-defining-your-metrics">Exercise 4-1 Defining Your Metrics</a></li>
        
            <li><a href="#exercise-4-2-extracting-data-from-the-database-using-sql">Exercise 4-2 Extracting Data From The Database Using SQL</a></li>
        
            <li><a href="#exercise-4-3-sending-extracted-data-using-measurement-api">Exercise 4-3 Sending Extracted Data Using Measurement API</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="lab-4-metric-and-measurement-apis">Lab 4 - Metric and Measurement APIs</h1>
<h2 id="overview">Overview</h2>
<p>This lab will introduce you to the Metric and Measurement APIs by showing you how to
extracting example business data from a MySQL database and sending the business data
to TrueSight Intelligence.</p>
<h3 id="metrics-versus-measurements">Metrics versus Measurements</h3>
<p><em>Metrics</em> and <em>Measurements</em> are often used interchangeable by in the context of the TrueSight Intelligence APIs
we need to make a distinction as follows:</p>
<ul>
<li><em>Metrics</em> are the <em>definition</em> of what the time series represents</li>
<li><em>Measurements</em> are the <em>actual</em> time series values that are collected</li>
</ul>
<h4 id="metric">Metric</h4>
<p>A metric definitions consists of the following:</p>
<ul>
<li>Name</li>
<li>Display Name</li>
<li>Display Name Short</li>
<li>Description</li>
<li>Default Aggregate</li>
<li>Default Resolution</li>
<li>Type</li>
<li>Units</li>
</ul>
<h5 id="name">Name</h5>
<p>This is the primary key and is used to uniquely identify each metric in an account. The name is all
uppercase with addition of underscores(<code>_</code>) and periods('.'). Some of the built-in metrics include:
CPU, Network In, or Data Disk Out.</p>
<h5 id="display-name">Display Name</h5>
<p>Label to identify the metric in the user interface or other place where user readable text is needed.</p>
<h5 id="display-name-short">Display Name Short</h5>
<p>Same use as <em>Display Name</em> but in those cases where shortened text is required (limit to 20 characters).</p>
<h5 id="description">Description</h5>
<p>Provides textual information or other information relevant in describing the metric.</p>
<h5 id="default-aggregate">Default Aggregate</h5>
<p>When graphing the metric that makes the most sense, which is one of:</p>
<ul>
<li>Average</li>
<li>Minimum</li>
<li>Maximum</li>
<li>Sum</li>
</ul>
<h5 id="type">Type</h5>
<p><strong>TODO</strong> What is the type user for in TrueSight Intelligence?</p>
<h5 id="unit">Unit</h5>
<p>This field consists of an enumerated type the describes the unit of meaurement of the metric. The types
consist of the following;</p>
<ul>
<li>ByteCount</li>
<li>Duration</li>
<li>Number</li>
<li>Percent</li>
</ul>
<p><em>NOTE</em>: <em>Duration</em> is milliseconds and is not current configurable. Percent is given in decimal form, for
example %63.2 would be given as 0.632.</p>
<h4 id="measurements">Measurements</h4>
<p>Are the time series data collected for a particular <em>metric</em> which are made of the following:</p>
<ul>
<li>Metric</li>
<li>Value</li>
<li>Source</li>
<li>Timestamp</li>
</ul>
<h5 id="metric_1">Metric</h5>
<p>Refers to the specific <em>Metric</em> of the Measurement</p>
<h5 id="value">Value</h5>
<p>Value of the metric at the given timestamp. If the Metric unit is <em>percent</em> then this is value in its
decimal equivalent.</p>
<h5 id="source">Source</h5>
<p>Most often the system hostname but it is used to indicate the specific instance of the thing being measured. For
example if were measuring individual utilization for CPU cores the source would refer to the specific core.</p>
<h5 id="timestamp">Timestamp</h5>
<p>When the measurement occurred in <a href="https://en.wikipedia.org/wiki/Unix_time">UNIX epoch time</a> which is either
in seconds or milliseconds.</p>
<h5 id="properties">Properties</h5>
<p>In addition to the previously discussed Measurement fields, there are optional fields for further
classification of a measurement.</p>
<p>The <em>Application Id</em> is used to organize data in TrueSight Intelligence.</p>
<p><strong>To Be Discussed</strong></p>
<h2 id="metric-and-measurement-apis">Metric and Measurement APIs</h2>
<p>Online documentation of the Metric and Measurement APIs is located
<a href="https://documentation.truesight.bmc.com/overview">here</a></p>
<h3 id="metric-api">Metric API</h3>
<h4 id="creating-a-metric-definition-with-curl">Creating a Metric definition with <code>curl</code></h4>
<h4 id="creating-a-metric-definition-with-metric-create">Creating a Metric definition with <code>metric-create</code></h4>
<h4 id="creating-a-metric-definition-with-python-measurement-api">Creating a Metric definition with Python Measurement API</h4>
<h3 id="measurement-api">Measurement API</h3>
<h2 id="business-data">Business Data</h2>
<p>This section describes</p>
<h3 id="mariadb">MariaDB</h3>
<p>For this lab we are using the <a href="https://en.wikipedia.org/wiki/MariaDB">MariaDB</a> which is a drop in replacement
for [MySQL])(https://en.wikipedia.org/wiki/MySQL)</p>
<pre><code>MariaDB [app]&gt; show tables;
+------------------+
| Tables_in_app    |
+------------------+
| business_metrics |
| ol_activity      |
| ol_cart          |
| ol_sales         |
| ol_transactions  |
+------------------+
5 rows in set (0.00 sec)

MariaDB [app]&gt;
</code></pre>

<pre><code>CREATE TABLE ol_activity
(
  id BIGINT AUTO_INCREMENT PRIMARY KEY,
  dt DATETIME NOT NULL,
  online BIGINT NOT NULL
);
</code></pre>

<h3 id="running-mariadb-queries">Running MariaDB Queries</h3>
<ol>
<li>
<p>At the command line run the following:</p>
<p><code>mysqldb</code></p>
</li>
<li>
<p>This will display the following prompt:</p>
<p>```
 [vagrant@tsi-lab-01 ~]$ mysqldb
 Reading table information for completion of table and column names
 You can turn off this feature to get a quicker startup with -A</p>
<p>Welcome to the MariaDB monitor.  Commands end with ; or \g.
 Your MariaDB connection id is 129
 Server version: 5.5.47-MariaDB MariaDB Server</p>
<p>Copyright (c) 2000, 2015, Oracle, MariaDB Corporation Ab and others.</p>
<p>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</p>
<p>MariaDB [app]&gt;</p>
<p>```</p>
</li>
<li>
<p>Run the following:</p>
<p><code>MariaDB [app]&gt; select * from ol_transactions limit 10;</code></p>
</li>
<li>
<p>Which will display output similar to below:</p>
</li>
</ol>
<pre><code>+----+---------------------+-------+----------+
| id | dt                  | total | duration |
+----+---------------------+-------+----------+
|  1 | 2016-04-18 17:26:00 |   726 |   407.31 |
|  2 | 2016-04-18 17:27:00 |   769 |   330.11 |
|  3 | 2016-04-18 17:28:00 |   529 |   460.87 |
|  4 | 2016-04-18 17:29:00 |   259 |   170.36 |
|  5 | 2016-04-18 17:30:00 |   703 |   277.52 |
|  6 | 2016-04-18 17:31:00 |   816 |   726.88 |
|  7 | 2016-04-18 17:32:00 |   465 |   150.15 |
|  8 | 2016-04-18 17:33:00 |    84 |   166.53 |
|  9 | 2016-04-18 17:34:00 |   624 |    228.7 |
| 10 | 2016-04-18 17:35:00 |   577 |   720.33 |
+----+---------------------+-------+----------+
10 rows in set (0.00 sec)
</code></pre>

<h2 id="exercise-4-1-defining-your-metrics">Exercise 4-1 Defining Your Metrics</h2>
<p>Run the script <code>labs\lab-4\ex-4-1.metrics.py</code>.</p>
<ol>
<li>
<p>Change directory to your home directory:</p>
<p><code>$ cd</code></p>
</li>
<li>
<p>Run the following:</p>
<p><code>$ labs\lab-3\ex-4-1.metrics.py</code></p>
</li>
</ol>
<h2 id="exercise-4-2-extracting-data-from-the-database-using-sql">Exercise 4-2 Extracting Data From The Database Using SQL</h2>
<p>Run the script <code>labs\lab-4\ex-4-2.metrics.py</code>.</p>
<ol>
<li>
<p>Change directory to your home directory:</p>
<p><code>$ cd</code></p>
</li>
<li>
<p>Run the following:</p>
<p><code>$ labs\lab-3\ex-4-2.metrics.py</code></p>
</li>
</ol>
<h2 id="exercise-4-3-sending-extracted-data-using-measurement-api">Exercise 4-3 Sending Extracted Data Using Measurement API</h2>
<p>Run the script <code>labs\lab-4\ex-4-3.metrics.py</code>.</p>
<ol>
<li>
<p>Change directory to your home directory:</p>
<p><code>$ cd</code></p>
</li>
<li>
<p>Run the following:</p>
<p><code>$ labs\lab-3\ex-4-3.metrics.py</code></p>
</li>
</ol></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>